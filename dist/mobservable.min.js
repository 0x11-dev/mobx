(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.mobservable = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
function observable(e,r){if("string"==typeof arguments[1])return observableDecorator.apply(null,arguments);switch(arguments.length){case 0:throw new Error("[mobservable.observable] Please provide at least one argument.");case 1:break;case 2:if("function"==typeof e)break;throw new Error("[mobservable.observable] Only one argument expected.");default:throw new Error("[mobservable.observable] Too many arguments. Please provide exactly one argument, or a function and a scope.")}if(isObservable(e))return e;var t=getValueModeFromValue(e,ValueMode.Recursive),a=t[0],n=t[1],o=a===ValueMode.Reference?ValueType.Reference:getTypeOfValue(n);switch(o){case ValueType.Reference:case ValueType.ComplexObject:return toGetterSetterFunction(new observablevalue_1.ObservableValue(n,a,null));case ValueType.ComplexFunction:throw new Error("[mobservable.observable] To be able to make a function reactive it shoul dnot have arguments. If you need an observable reference to a function, use `observable(asReference(f))`");case ValueType.ViewFunction:var u={name:n.name,object:n};return toGetterSetterFunction(new observableview_1.ObservableView(n,r,u,a===ValueMode.Structure));case ValueType.Array:case ValueType.PlainObject:return makeChildObservable(n,a,null)}throw"Illegal State"}function map(e,r){return new observablemap_1.ObservableMap(e,r)}function asReference(e){return new AsReference(e)}function asStructure(e){return new AsStructure(e)}function asFlat(e){return new AsFlat(e)}function isObservable(e){return null===e||void 0===e?!1:!!e.$mobservable||e instanceof dnode_2.DataNode}function autorun(e,r){var t=getValueModeFromValue(e,ValueMode.Recursive),a=t[0],n=t[1];if("function"!=typeof n)throw new Error("[mobservable.autorun] expects a function");if(0!==n.length)throw new Error("[mobservable.autorun] expects a function without arguments");var o=new observableview_1.ObservableView(n,r,{object:r||e,name:e.name},a===ValueMode.Structure);o.setRefCount(1);var u=utils_1.once(function(){o.setRefCount(-1)});return u.$mobservable=o,u}function autorunUntil(e,r,t){var a=autorun(function(){e.call(t)&&(a(),r.call(t))});return a}function autorunAsync(e,r,t,a){void 0===t&&(t=1);var n,o=void 0,u=autorun(function(){o=e.call(a),n||(n=setTimeout(function(){r.call(a,o),n=null},t))});return utils_1.once(function(){u(),n&&clearTimeout(n)})}function expr(e,r){return dnode_1.isComputingView()||console.warn("[mobservable.expr] 'expr' should only be used inside other reactive functions."),observable(e,r)()}function extendObservable(e,r,t){if(e instanceof observablemap_1.ObservableMap||r instanceof observablemap_1.ObservableMap)throw new Error("[mobservable.extendObservable] 'extendObservable' should not be used on maps, use map.merge instead");return extendObservableHelper(e,r,ValueMode.Recursive,t)}function observableDecorator(e,r,t){if(arguments.length<2||arguments.length>3)throw new Error("[mobservable.@observable] A decorator expects 2 or 3 arguments, got: "+arguments.length);var a=t&&t.hasOwnProperty("get"),n={},o=void 0;if(t&&(t.hasOwnProperty("get")?o=t.get:t.hasOwnProperty("value")?o=t.value:t.initializer&&(o=t.initializer(),"function"==typeof o&&(o=asReference(o)))),!e||"object"!=typeof e)throw new Error("The @observable decorator can only be used on objects");if(a){if("function"!=typeof o)throw new Error("@observable expects a getter function if used on a property (in member: '"+r+"').");if(n.set)throw new Error("@observable properties cannot have a setter (in member: '"+r+"').");if(0!==o.length)throw new Error("@observable getter functions should not take arguments (in member: '"+r+"').")}return n.configurable=!0,n.enumerable=!0,n.get=function(){var e=this;return withStrict(!1,function(){observableobject_1.ObservableObject.asReactive(e,null,ValueMode.Recursive).set(r,o)}),this[r]},n.set=a?observableview_1.throwingViewSetter(r):function(e){observableobject_1.ObservableObject.asReactive(this,null,ValueMode.Recursive).set(r,"function"==typeof e?asReference(e):e)},t?n:void Object.defineProperty(e,r,n)}function toJSON(e){if(!e)return e;if(Array.isArray(e)||e instanceof observablearray_1.ObservableArray)return e.map(toJSON);if(e instanceof observablemap_1.ObservableMap){var r={};return e.forEach(function(e,t){return r[t]=e}),r}if("object"==typeof e&&utils_1.isPlainObject(e)){var t={};for(var a in e)e.hasOwnProperty(a)&&(t[a]=toJSON(e[a]));return t}return e}function transaction(e){return scheduler_1.transaction(e)}function getStrict(){return strict}function withStrict(e,r){var t=strict;strict=e;try{r()}finally{strict=t}}function getTypeOfValue(e){return null===e||void 0===e?ValueType.Reference:"function"==typeof e?e.length?ValueType.ComplexFunction:ValueType.ViewFunction:Array.isArray(e)||e instanceof observablearray_1.ObservableArray?ValueType.Array:"object"==typeof e?utils_1.isPlainObject(e)?ValueType.PlainObject:ValueType.ComplexObject:ValueType.Reference}function extendObservableHelper(e,r,t,a){var n=observableobject_1.ObservableObject.asReactive(e,a,t);for(var o in r)r.hasOwnProperty(o)&&n.set(o,r[o]);return e}function toGetterSetterFunction(e){var r=function(r){return arguments.length>0?void e.set(r):e.get()};return r.$mobservable=e,r.observe=function(r,t){return e.observe(r,t)},r.toString=function(){return e.toString()},r}function getValueModeFromValue(e,r){return e instanceof AsReference?[ValueMode.Reference,e.value]:e instanceof AsStructure?[ValueMode.Structure,e.value]:e instanceof AsFlat?[ValueMode.Flat,e.value]:[r,e]}function getValueModeFromModifierFunc(e){if(e===asReference)return ValueMode.Reference;if(e===asStructure)return ValueMode.Structure;if(e===asFlat)return ValueMode.Flat;if(void 0!==e)throw new Error("[mobservable] Cannot determine value mode from function. Please pass in one of these: mobservable.asReference, mobservable.asStructure or mobservable.asFlat, got: "+e);return ValueMode.Recursive}function makeChildObservable(e,r,t){var a;if(isObservable(e))return e;switch(r){case ValueMode.Reference:return e;case ValueMode.Flat:assertUnwrapped(e,"Items inside 'asFlat' canont have modifiers"),a=ValueMode.Reference;break;case ValueMode.Structure:assertUnwrapped(e,"Items inside 'asStructure' canont have modifiers"),a=ValueMode.Structure;break;case ValueMode.Recursive:n=getValueModeFromValue(e,ValueMode.Recursive),a=n[0],e=n[1];break;default:throw"Illegal State"}return Array.isArray(e)?observablearray_1.createObservableArray(e.slice(),a,t):utils_1.isPlainObject(e)?extendObservableHelper(e,e,a,t):e;var n}function assertUnwrapped(e,r){if(e instanceof AsReference||e instanceof AsStructure||e instanceof AsFlat)throw new Error("[mobservable] asStructure / asReference / asFlat cannot be used here. "+r)}var dnode_1=require("./dnode"),utils_1=require("./utils"),observablevalue_1=require("./observablevalue"),observableview_1=require("./observableview"),observablearray_1=require("./observablearray"),observableobject_1=require("./observableobject"),observablemap_1=require("./observablemap"),scheduler_1=require("./scheduler"),dnode_2=require("./dnode");exports.observable=observable,exports.map=map,exports.asReference=asReference,exports.asStructure=asStructure,exports.asFlat=asFlat,exports.isObservable=isObservable,exports.autorun=autorun,exports.autorunUntil=autorunUntil,exports.autorunAsync=autorunAsync,exports.expr=expr,exports.extendObservable=extendObservable,exports.toJSON=toJSON,exports.transaction=transaction;var strict=!1;exports.getStrict=getStrict,exports.withStrict=withStrict,function(e){e[e.Reference=0]="Reference",e[e.PlainObject=1]="PlainObject",e[e.ComplexObject=2]="ComplexObject",e[e.Array=3]="Array",e[e.ViewFunction=4]="ViewFunction",e[e.ComplexFunction=5]="ComplexFunction"}(exports.ValueType||(exports.ValueType={}));var ValueType=exports.ValueType;!function(e){e[e.Recursive=0]="Recursive",e[e.Reference=1]="Reference",e[e.Structure=2]="Structure",e[e.Flat=3]="Flat"}(exports.ValueMode||(exports.ValueMode={}));var ValueMode=exports.ValueMode;exports.getTypeOfValue=getTypeOfValue,exports.extendObservableHelper=extendObservableHelper,exports.toGetterSetterFunction=toGetterSetterFunction;var AsReference=function(){function e(e){this.value=e,assertUnwrapped(e,"Modifiers are not allowed to be nested")}return e}();exports.AsReference=AsReference;var AsStructure=function(){function e(e){this.value=e,assertUnwrapped(e,"Modifiers are not allowed to be nested")}return e}();exports.AsStructure=AsStructure;var AsFlat=function(){function e(e){this.value=e,assertUnwrapped(e,"Modifiers are not allowed to be nested")}return e}();exports.AsFlat=AsFlat,exports.getValueModeFromValue=getValueModeFromValue,exports.getValueModeFromModifierFunc=getValueModeFromModifierFunc,exports.makeChildObservable=makeChildObservable,exports.assertUnwrapped=assertUnwrapped;

},{"./dnode":2,"./observablearray":6,"./observablemap":7,"./observableobject":8,"./observablevalue":9,"./observableview":10,"./scheduler":11,"./utils":13}],2:[function(require,module,exports){
(function (global){
function checkIfStateIsBeingModifiedDuringView(e){if(core_1.getStrict()===!0&&isComputingView()){var t=global.__mobservableViewStack;throw new Error("[mobservable] It is not allowed to change the state during the computation of a reactive view. Should the data you are trying to modify actually be a view? \nUse 'mobservable.extras.withStrict(false, block)' to allow changes to be made inside views (unrecommended).\nView name: "+e.name+".\nCurrent stack size is "+t.length+', active view: "'+t[t.length-1].toString()+'".')}}function stackDepth(){return global.__mobservableViewStack.length}function isComputingView(){return global.__mobservableViewStack.length>0}var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};if(global.__mobservableTrackingStack)throw new Error("[mobservable] An incompatible version of mobservable is already loaded.");global.__mobservableViewStack=[];var mobservableId=0;exports.checkIfStateIsBeingModifiedDuringView=checkIfStateIsBeingModifiedDuringView,function(e){e[e.STALE=0]="STALE",e[e.PENDING=1]="PENDING",e[e.READY=2]="READY"}(exports.NodeState||(exports.NodeState={}));var NodeState=exports.NodeState,DataNode=function(){function e(e){this.id=++mobservableId,this.state=NodeState.READY,this.observers=[],this.isDisposed=!1,this.externalRefenceCount=0,e||(e={name:void 0,object:void 0}),e.name||(e.name="[m#"+this.id+"]"),this.context=e}return e.prototype.setRefCount=function(e){this.externalRefenceCount+=e},e.prototype.addObserver=function(e){this.observers[this.observers.length]=e},e.prototype.removeObserver=function(e){var t=this.observers,i=t.indexOf(e);-1!==i&&t.splice(i,1)},e.prototype.markStale=function(){this.state===NodeState.READY&&(this.state=NodeState.STALE,extras_1.transitionTracker&&extras_1.reportTransition(this,"STALE"),this.notifyObservers())},e.prototype.markReady=function(e){this.state!==NodeState.READY&&(this.state=NodeState.READY,extras_1.transitionTracker&&extras_1.reportTransition(this,"READY",!0,this._value),this.notifyObservers(e))},e.prototype.notifyObservers=function(e){void 0===e&&(e=!1);for(var t=this.observers.slice(),i=t.length,o=0;i>o;o++)t[o].notifyStateChange(this,e)},e.prototype.notifyObserved=function(){var e=global.__mobservableViewStack,t=e.length;if(t>0){var i=e[t-1].observing,o=i.length;i[o-1]!==this&&i[o-2]!==this&&(i[o]=this)}},e.prototype.dispose=function(){if(this.observers.length)throw new Error("[mobservable] Cannot dispose DNode; it is still being observed");this.isDisposed=!0},e.prototype.toString=function(){return"DNode["+this.context.name+", state: "+this.state+", observers: "+this.observers.length+"]"},e}();exports.DataNode=DataNode;var ViewNode=function(e){function t(){e.apply(this,arguments),this.isSleeping=!0,this.hasCycle=!1,this.observing=[],this.prevObserving=null,this.dependencyChangeCount=0,this.dependencyStaleCount=0}return __extends(t,e),t.prototype.setRefCount=function(e){var t=this.externalRefenceCount+=e;0===t?this.tryToSleep():t===e&&this.wakeUp()},t.prototype.removeObserver=function(t){e.prototype.removeObserver.call(this,t),this.tryToSleep()},t.prototype.tryToSleep=function(){if(!this.isSleeping&&0===this.observers.length&&0===this.externalRefenceCount){for(var e=0,t=this.observing.length;t>e;e++)this.observing[e].removeObserver(this);this.observing=[],this.isSleeping=!0}},t.prototype.wakeUp=function(){this.isSleeping&&(this.isSleeping=!1,this.state=NodeState.PENDING,this.computeNextState())},t.prototype.notifyStateChange=function(e,t){var i=this;e.state===NodeState.STALE?1===++this.dependencyStaleCount&&this.markStale():(t&&(this.dependencyChangeCount+=1),0===--this.dependencyStaleCount&&(this.state=NodeState.PENDING,scheduler_1.schedule(function(){i.dependencyChangeCount>0?i.computeNextState():i.markReady(!1),i.dependencyChangeCount=0})))},t.prototype.computeNextState=function(){var e=this;this.trackDependencies(),extras_1.transitionTracker&&extras_1.reportTransition(this,"PENDING");var t=!0;try{var i;core_1.withStrict(0===this.externalRefenceCount,function(){i=e.compute()}),t=!1}finally{t&&console.error("[mobservable.view '"+this.context.name+"'] There was an uncaught error during the computation of "+this.toString()),this.isComputing=!1,this.bindDependencies(),this.markReady(i)}},t.prototype.compute=function(){throw"Abstract!"},t.prototype.trackDependencies=function(){this.prevObserving=this.observing,this.observing=[],global.__mobservableViewStack[global.__mobservableViewStack.length]=this},t.prototype.bindDependencies=function(){global.__mobservableViewStack.length-=1;var e=utils_1.quickDiff(this.observing,this.prevObserving),i=e[0],o=e[1];this.prevObserving=null,this.hasCycle=!1;for(var r=0,s=i.length;s>r;r++){var n=i[r];n instanceof t&&n.findCycle(this)?(this.hasCycle=!0,this.observing.splice(this.observing.indexOf(i[r]),1),n.hasCycle=!0):i[r].addObserver(this)}for(var r=0,s=o.length;s>r;r++)o[r].removeObserver(this)},t.prototype.findCycle=function(e){var i=this.observing;if(-1!==i.indexOf(e))return!0;for(var o=i.length,r=0;o>r;r++)if(i[r]instanceof t&&i[r].findCycle(e))return!0;return!1},t.prototype.dispose=function(){if(this.observing)for(var t=this.observing.length,i=0;t>i;i++)this.observing[i].removeObserver(this);this.observing=null,e.prototype.dispose.call(this)},t}(DataNode);exports.ViewNode=ViewNode,exports.stackDepth=stackDepth,exports.isComputingView=isComputingView;var core_1=require("./core"),extras_1=require("./extras"),utils_1=require("./utils"),scheduler_1=require("./scheduler");

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./core":1,"./extras":3,"./scheduler":11,"./utils":13}],3:[function(require,module,exports){
function getDNode(e,r){if(!core_1.isObservable(e))throw new Error("[mobservable.getDNode] "+e+" doesn't seem to be reactive");if(void 0!==r){var t;if(e instanceof observablemap_1.ObservableMap)t=e._data[r];else if(e.$mobservable instanceof observableobject_1.ObservableObject){var o=e.$mobservable;t=o.values&&o.values[r]}if(!t)throw new Error("[mobservable.getDNode] property '"+r+"' of '"+e+"' doesn't seem to be a reactive property");return t}if(e instanceof dnode_1.DataNode)return e;if(e.$mobservable){if(e.$mobservable instanceof observableobject_1.ObservableObject||e instanceof observablemap_1.ObservableMap)throw new Error("[mobservable.getDNode] missing properties parameter. Please specify a property of '"+e+"'.");return e.$mobservable}throw new Error("[mobservable.getDNode] "+e+" doesn't seem to be reactive")}function reportTransition(e,r,t,o){void 0===t&&(t=!1),void 0===o&&(o=null),exports.transitionTracker.emit({id:e.id,name:e.context.name,context:e.context.object,state:r,changed:t,newValue:o})}function getDependencyTree(e,r){return nodeToDependencyTree(getDNode(e,r))}function nodeToDependencyTree(e){var r={id:e.id,name:e.context.name,context:e.context.object||null};return e instanceof dnode_1.ViewNode&&e.observing.length&&(r.dependencies=utils_1.unique(e.observing).map(nodeToDependencyTree)),r}function getObserverTree(e,r){return nodeToObserverTree(getDNode(e,r))}function nodeToObserverTree(e){var r={id:e.id,name:e.context.name,context:e.context.object||null};return e.observers.length&&(r.observers=utils_1.unique(e.observers).map(nodeToObserverTree)),e.externalRefenceCount>0&&(r.listeners=e.externalRefenceCount),r}function createConsoleReporter(e){var r=[],t=!1;return function(o){(e||o.changed)&&r.push(o),t||(t=!0,setTimeout(function(){console[console.table?"table":"dir"](r),r=[],t=!1},1))}}function trackTransitions(e,r){void 0===e&&(e=!1),exports.transitionTracker||(exports.transitionTracker=new simpleeventemitter_1["default"]);var t=r?function(t){(e||t.changed)&&r(t)}:createConsoleReporter(e),o=exports.transitionTracker.on(t);return utils_1.once(function(){o(),0===exports.transitionTracker.listeners.length&&(exports.transitionTracker=null)})}var dnode_1=require("./dnode"),observableobject_1=require("./observableobject"),observablemap_1=require("./observablemap"),simpleeventemitter_1=require("./simpleeventemitter"),utils_1=require("./utils"),core_1=require("./core");exports.getDNode=getDNode,exports.reportTransition=reportTransition,exports.transitionTracker=null,exports.getDependencyTree=getDependencyTree,exports.getObserverTree=getObserverTree,exports.trackTransitions=trackTransitions;

},{"./core":1,"./dnode":2,"./observablemap":7,"./observableobject":8,"./simpleeventemitter":12,"./utils":13}],4:[function(require,module,exports){
function __export(e){for(var r in e)exports.hasOwnProperty(r)||(exports[r]=e[r])}var core=require("./core"),dnode_1=require("./dnode"),utils_1=require("./utils"),extras_1=require("./extras"),simpleeventemitter_1=require("./simpleeventemitter");__export(require("./interfaces"));var core_1=require("./core");exports.isObservable=core_1.isObservable,exports.observable=core_1.observable,exports.extendObservable=core_1.extendObservable,exports.asReference=core_1.asReference,exports.asFlat=core_1.asFlat,exports.asStructure=core_1.asStructure,exports.autorun=core_1.autorun,exports.autorunUntil=core_1.autorunUntil,exports.autorunAsync=core_1.autorunAsync,exports.expr=core_1.expr,exports.transaction=core_1.transaction,exports.toJSON=core_1.toJSON,exports.isReactive=core_1.isObservable,exports.map=core_1.map,exports.makeReactive=core_1.observable,exports.extendReactive=core_1.extendObservable,exports.observe=core_1.autorun,exports.observeUntil=core_1.autorunUntil,exports.observeAsync=core_1.autorunAsync,exports._={isComputingView:dnode_1.isComputingView,quickDiff:utils_1.quickDiff},exports.extras={getDNode:extras_1.getDNode,getDependencyTree:extras_1.getDependencyTree,getObserverTree:extras_1.getObserverTree,trackTransitions:extras_1.trackTransitions,SimpleEventEmitter:simpleeventemitter_1["default"],withStrict:core.withStrict};

},{"./core":1,"./dnode":2,"./extras":3,"./interfaces":5,"./simpleeventemitter":12,"./utils":13}],5:[function(require,module,exports){

},{}],6:[function(require,module,exports){
function createObservableArray(e,t,r){return new ObservableArray(e,t,r)}function createArrayBufferItem(e){var t=ENUMERABLE_PROPS[e]={enumerable:!0,configurable:!0,set:function(t){var r=this.$mobservable,a=r.values;if(core_1.assertUnwrapped(t,"Modifiers cannot be used on array values. For non-reactive array values use makeReactive(asFlat(array))."),e<a.length){dnode_1.checkIfStateIsBeingModifiedDuringView(r.context);var n=a[e],o=r.mode===core_1.ValueMode.Structure?!utils_1.deepEquals(n,t):n!==t;o&&(a[e]=r.makeReactiveArrayItem(t),r.notifyChildUpdate(e,n))}else{if(e!==a.length)throw new Error("[mobservable.array] Index out of bounds, "+e+" is larger than "+a.length);this.push(r.makeReactiveArrayItem(t))}},get:function(){var t=this.$mobservable;return t&&e<t.values.length?(t.notifyObserved(),t.values[e]):void 0}};Object.defineProperty(ObservableArray.prototype,""+e,{enumerable:!1,configurable:!0,get:t.get,set:t.set})}function reserveArrayBuffer(e){for(var t=OBSERVABLE_ARRAY_BUFFER_SIZE;e>t;t++)createArrayBufferItem(t);OBSERVABLE_ARRAY_BUFFER_SIZE=e}var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},utils_1=require("./utils"),dnode_1=require("./dnode"),simpleeventemitter_1=require("./simpleeventemitter"),core_1=require("./core"),StubArray=function(){function e(){}return e}();exports.StubArray=StubArray,StubArray.prototype=[];var ObservableArrayAdministration=function(e){function t(t,r,a){e.call(this,a?a:{name:void 0,object:void 0}),this.array=t,this.mode=r,this.values=[],this.changeEvent=new simpleeventemitter_1["default"],this.context.object||(this.context.object=t)}return __extends(t,e),t.prototype.getLength=function(){return this.notifyObserved(),this.values.length},t.prototype.setLength=function(e){if("number"!=typeof e||0>e)throw new Error("[mobservable.array] Out of range: "+e);var t=this.values.length;e!==t&&(e>t?this.spliceWithArray(t,0,new Array(e-t)):this.spliceWithArray(e,t-e))},t.prototype.updateLength=function(e,t){if(0>t){dnode_1.checkIfStateIsBeingModifiedDuringView(this.context);for(var r=e+t;e>r;r++)delete this.array[r]}else if(t>0){dnode_1.checkIfStateIsBeingModifiedDuringView(this.context),e+t>OBSERVABLE_ARRAY_BUFFER_SIZE&&reserveArrayBuffer(e+t);for(var r=e,a=e+t;a>r;r++)Object.defineProperty(this.array,r,ENUMERABLE_PROPS[r])}},t.prototype.spliceWithArray=function(e,t,r){var a=this,n=this.values.length;if(!(void 0!==r&&0!==r.length||0!==t&&0!==n))return[];void 0===e?e=0:e>n?e=n:0>e&&(e=Math.max(0,n+e)),t=1===arguments.length?n-e:void 0===t||null===t?0:Math.max(0,Math.min(t,n-e)),r=void 0===r?[]:r.map(function(e){return a.makeReactiveArrayItem(e)});var o=r.length-t;this.updateLength(n,o);var i=(s=this.values).splice.apply(s,[e,t].concat(r));return this.notifySplice(e,i,r),i;var s},t.prototype.makeReactiveArrayItem=function(e){return core_1.assertUnwrapped(e,"Array values cannot have modifiers"),core_1.makeChildObservable(e,this.mode,{object:this.context.object,name:this.context.name+"[x]"})},t.prototype.notifyChildUpdate=function(e,t){this.notifyChanged(),this.changeEvent.emit({object:this.array,type:"update",index:e,oldValue:t})},t.prototype.notifySplice=function(e,t,r){(0!==t.length||0!==r.length)&&(this.notifyChanged(),this.changeEvent.emit({object:this.array,type:"splice",index:e,addedCount:r.length,removed:t}))},t.prototype.notifyChanged=function(){this.markStale(),this.markReady(!0)},t}(dnode_1.DataNode);exports.ObservableArrayAdministration=ObservableArrayAdministration,exports.createObservableArray=createObservableArray;var ObservableArray=function(e){function t(t,r,a){e.call(this),Object.defineProperty(this,"$mobservable",{enumerable:!1,configurable:!1,value:new ObservableArrayAdministration(this,r,a)}),t&&t.length&&this.replace(t)}return __extends(t,e),t.prototype.observe=function(e,t){return void 0===t&&(t=!1),t&&e({object:this,type:"splice",index:0,addedCount:this.$mobservable.values.length,removed:[]}),this.$mobservable.changeEvent.on(e)},t.prototype.clear=function(){return this.splice(0)},t.prototype.replace=function(e){return this.$mobservable.spliceWithArray(0,this.$mobservable.values.length,e)},t.prototype.toJSON=function(){return this.$mobservable.notifyObserved(),this.$mobservable.values.slice()},t.prototype.find=function(e,t,r){void 0===r&&(r=0),this.$mobservable.notifyObserved();for(var a=this.$mobservable.values,n=a.length,o=r;n>o;o++)if(e.call(t,a[o],o,this))return a[o];return null},t.prototype.splice=function(e,t){for(var r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];switch(arguments.length){case 0:return[];case 1:return this.$mobservable.spliceWithArray(e);case 2:return this.$mobservable.spliceWithArray(e,t)}return this.$mobservable.spliceWithArray(e,t,r)},t.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this.$mobservable.spliceWithArray(this.$mobservable.values.length,0,e),this.$mobservable.values.length},t.prototype.pop=function(){return this.splice(Math.max(this.$mobservable.values.length-1,0),1)[0]},t.prototype.shift=function(){return this.splice(0,1)[0]},t.prototype.unshift=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this.$mobservable.spliceWithArray(0,0,e),this.$mobservable.values.length},t.prototype.reverse=function(){return this.replace(this.$mobservable.values.reverse())},t.prototype.sort=function(e){return this.replace(this.$mobservable.values.sort.apply(this.$mobservable.values,arguments))},t.prototype.remove=function(e){var t=this.$mobservable.values.indexOf(e);return t>-1?(this.splice(t,1),!0):!1},t.prototype.toString=function(){return"[mobservable.array] "+Array.prototype.toString.apply(this.$mobservable.values,arguments)},t.prototype.toLocaleString=function(){return"[mobservable.array] "+Array.prototype.toLocaleString.apply(this.$mobservable.values,arguments)},t}(StubArray);exports.ObservableArray=ObservableArray,utils_1.makeNonEnumerable(ObservableArray.prototype,["constructor","clear","find","observe","pop","push","remove","replace","reverse","shift","sort","splice","split","toJSON","toLocaleString","toString","unshift"]),Object.defineProperty(ObservableArray.prototype,"length",{enumerable:!1,configurable:!0,get:function(){return this.$mobservable.getLength()},set:function(e){this.$mobservable.setLength(e)}}),["concat","every","filter","forEach","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some"].forEach(function(e){var t=Array.prototype[e];Object.defineProperty(ObservableArray.prototype,e,{configurable:!1,writable:!0,enumerable:!1,value:function(){return this.$mobservable.notifyObserved(),t.apply(this.$mobservable.values,arguments)}})});var OBSERVABLE_ARRAY_BUFFER_SIZE=0,ENUMERABLE_PROPS=[];reserveArrayBuffer(1e3);

},{"./core":1,"./dnode":2,"./simpleeventemitter":12,"./utils":13}],7:[function(require,module,exports){
var observablevalue_1=require("./observablevalue"),core_1=require("./core"),simpleeventemitter_1=require("./simpleeventemitter"),observablearray_1=require("./observablearray"),ObservableMap=function(){function e(e,t){this.$mobservable=!0,this._data={},this._hasMap={},this._keys=new observablearray_1.ObservableArray(null,core_1.ValueMode.Reference,{name:".keys()",object:this}),this._events=new simpleeventemitter_1["default"],this._valueMode=core_1.getValueModeFromModifierFunc(t),e&&this.merge(e)}return e.prototype._has=function(e){return"undefined"!=typeof this._data[e]},e.prototype.has=function(e){return this.assertValidKey(e),this._hasMap[e]?this._hasMap[e].get():this._updateHasMapEntry(e,!1).get()},e.prototype.set=function(e,t){var r=this;if(this.assertValidKey(e),core_1.assertUnwrapped(t,"[mobservable.map.set] Expected unwrapped value to be inserted to key '"+e+"'. If you need to use modifiers pass them as second argument to the constructor"),this._has(e)){var a=this._data[e]._value,s=this._data[e].set(t);s&&this._events.emit({type:"update",object:this,name:e,oldValue:a})}else core_1.transaction(function(){r._data[e]=new observablevalue_1.ObservableValue(t,r._valueMode,{name:"."+e,object:r}),r._updateHasMapEntry(e,!0),r._keys.push(e)}),this._events.emit({type:"add",object:this,name:e})},e.prototype["delete"]=function(e){var t=this;if(this.assertValidKey(e),this._has(e)){var r=this._data[e]._value;core_1.transaction(function(){t._keys.remove(e),t._updateHasMapEntry(e,!1);var r=t._data[e];r.set(void 0),t._data[e]=void 0}),this._events.emit({type:"delete",object:this,name:e,oldValue:r})}},e.prototype._updateHasMapEntry=function(e,t){var r=this._hasMap[e];return r?r.set(t):r=this._hasMap[e]=new observablevalue_1.ObservableValue(t,core_1.ValueMode.Reference,{name:".(has)"+e,object:this}),r},e.prototype.get=function(e){return this.assertValidKey(e),this.has(e)?this._data[e].get():void 0},e.prototype.keys=function(){return this._keys.slice()},e.prototype.values=function(){return this.keys().map(this.get,this)},e.prototype.entries=function(){var e=this;return this.keys().map(function(t){return[t,e.get(t)]})},e.prototype.forEach=function(e,t){var r=this;this.keys().forEach(function(a){return e.call(t,r.get(a),a)})},e.prototype.merge=function(t){var r=this;return core_1.transaction(function(){t instanceof e?t.keys().forEach(function(e){return r.set(e,t.get(e))}):Object.keys(t).forEach(function(e){return r.set(e,t[e])})}),this},e.prototype.clear=function(){var e=this;core_1.transaction(function(){e.keys().forEach(e["delete"],e)})},e.prototype.size=function(){return this._keys.length},e.prototype.toJs=function(){var e=this,t={};return this.keys().forEach(function(r){return t[r]=e.get(r)}),t},e.prototype.assertValidKey=function(e){if(null===e||void 0===e)throw new Error("[mobservable.map] Invalid key: '"+e+"'");if("string"!=typeof e&&"number"!=typeof e)throw new Error("[mobservable.map] Invalid key: '"+e+"'")},e.prototype.toString=function(){var e=this;return"[mobservable.map { "+this.keys().map(function(t){return t+": "+e.get(t)}).join(", ")+" }]"},e.prototype.observe=function(e){return this._events.on(e)},e}();exports.ObservableMap=ObservableMap;

},{"./core":1,"./observablearray":6,"./observablevalue":9,"./simpleeventemitter":12}],8:[function(require,module,exports){
var core_1=require("./core"),observableview_1=require("./observableview"),observablevalue_1=require("./observablevalue"),ObservableObject=function(){function e(e,t,r){if(this.target=e,this.context=t,this.mode=r,this.values={},e.$mobservable)throw new Error("Illegal state: already an reactive object");t?t.object||(t.object=e):this.context={object:e,name:""},Object.defineProperty(e,"$mobservable",{enumerable:!1,configurable:!1,value:this})}return e.asReactive=function(t,r,a){return t.$mobservable?t.$mobservable:new e(t,r,a)},e.prototype.set=function(e,t){this.values[e]?this.target[e]=t:this.defineReactiveProperty(e,t)},e.prototype.defineReactiveProperty=function(e,t){var r,a={object:this.context.object,name:(this.context.name||"")+"."+e};r="function"==typeof t&&0===t.length?new observableview_1.ObservableView(t,this.target,a,!1):t instanceof core_1.AsStructure&&"function"==typeof t.value&&0===t.value.length?new observableview_1.ObservableView(t.value,this.target,a,!0):new observablevalue_1.ObservableValue(t,this.mode,a),this.values[e]=r,Object.defineProperty(this.target,e,{configurable:!0,enumerable:r instanceof observablevalue_1.ObservableValue,get:function(){return this.$mobservable?this.$mobservable.values[e].get():void 0},set:function(t){this.$mobservable.values[e].set(t)}})},e}();exports.ObservableObject=ObservableObject;

},{"./core":1,"./observablevalue":9,"./observableview":10}],9:[function(require,module,exports){
var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},dnode_1=require("./dnode"),simpleeventemitter_1=require("./simpleeventemitter"),core_1=require("./core"),utils_1=require("./utils"),ObservableValue=function(e){function t(t,i,r){e.call(this,r),this.value=t,this.mode=i,this.changeEvent=new simpleeventemitter_1["default"];var o=core_1.getValueModeFromValue(t,core_1.ValueMode.Recursive),n=o[0],s=o[1];this.mode===core_1.ValueMode.Recursive&&(this.mode=n),this._value=this.makeReferenceValueReactive(s)}return __extends(t,e),t.prototype.makeReferenceValueReactive=function(e){return core_1.makeChildObservable(e,this.mode,this.context)},t.prototype.set=function(e){core_1.assertUnwrapped(e,"Modifiers cannot be used on non-initial values."),dnode_1.checkIfStateIsBeingModifiedDuringView(this.context);var t=this.mode===core_1.ValueMode.Structure?!utils_1.deepEquals(e,this._value):e!==this._value;if(t){var i=this._value;this.markStale(),this._value=this.makeReferenceValueReactive(e),this.markReady(!0),this.changeEvent.emit(this._value,i)}return t},t.prototype.get=function(){return this.notifyObserved(),this._value},t.prototype.observe=function(e,t){return void 0===t&&(t=!1),t&&e(this.get(),void 0),this.changeEvent.on(e)},t.prototype.toString=function(){return"Observable["+this.context.name+":"+this._value+"]"},t}(dnode_1.DataNode);exports.ObservableValue=ObservableValue;

},{"./core":1,"./dnode":2,"./simpleeventemitter":12,"./utils":13}],10:[function(require,module,exports){
function throwingViewSetter(e){return function(){throw new Error("[mobservable.view '"+e+"'] View functions do not accept new values")}}var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},dnode_1=require("./dnode"),simpleeventemitter_1=require("./simpleeventemitter"),utils_1=require("./utils");exports.throwingViewSetter=throwingViewSetter;var ObservableView=function(e){function t(t,i,n,r){e.call(this,n),this.func=t,this.scope=i,this.compareStructural=r,this.isComputing=!1,this.changeEvent=new simpleeventemitter_1["default"]}return __extends(t,e),t.prototype.get=function(){if(this.isComputing)throw new Error("[mobservable.view '"+this.context.name+"'] Cycle detected");if(this.isSleeping?dnode_1.isComputingView()?(this.wakeUp(),this.notifyObserved()):(this.wakeUp(),this.tryToSleep()):this.notifyObserved(),this.hasCycle)throw new Error("[mobservable.view '"+this.context.name+"'] Cycle detected");return this._value},t.prototype.set=function(e){throwingViewSetter(this.context.name)()},t.prototype.compute=function(){if(this.isComputing)throw new Error("[mobservable.view '"+this.context.name+"'] Cycle detected");this.isComputing=!0;var e=this.func.call(this.scope);this.isComputing=!1;var t=this.compareStructural?!utils_1.deepEquals(e,this._value):e!==this._value;if(t){var i=this._value;return this._value=e,this.changeEvent.emit(e,i),!0}return!1},t.prototype.observe=function(e,t){var i=this;void 0===t&&(t=!1),this.setRefCount(1),t&&e(this.get(),void 0);var n=this.changeEvent.on(e);return utils_1.once(function(){i.setRefCount(-1),n()})},t.prototype.toString=function(){return"ComputedObservable["+this.context.name+":"+this._value+"] "+this.func.toString()},t}(dnode_1.ViewNode);exports.ObservableView=ObservableView;

},{"./dnode":2,"./simpleeventemitter":12,"./utils":13}],11:[function(require,module,exports){
function schedule(t){1>inBatch?t():tasks[tasks.length]=t}function runPostBatchActions(){for(var t=0;tasks.length;)try{for(;t<tasks.length;t++)tasks[t]();tasks=[]}catch(n){console.error("Failed to run scheduled action, the action has been dropped from the queue: "+n,n),tasks.splice(0,t+1)}}function transaction(t){inBatch+=1;try{return t()}finally{0===--inBatch&&(inBatch+=1,runPostBatchActions(),inBatch-=1)}}var inBatch=0,tasks=[];exports.schedule=schedule,exports.transaction=transaction;

},{}],12:[function(require,module,exports){
var utils_1=require("./utils"),SimpleEventEmitter=function(){function t(){this.listeners=[]}return t.prototype.emit=function(){var t=this.listeners.slice(),e=t.length;switch(arguments.length){case 0:for(var r=0;e>r;r++)t[r]();break;case 1:for(var n=arguments[0],r=0;e>r;r++)t[r](n);break;default:for(var r=0;e>r;r++)t[r].apply(null,arguments)}},t.prototype.on=function(t){var e=this;return this.listeners.push(t),utils_1.once(function(){var r=e.listeners.indexOf(t);-1!==r&&e.listeners.splice(r,1)})},t.prototype.once=function(t){var e=this.on(function(){e(),t.apply(this,arguments)});return e},t}();exports.__esModule=!0,exports["default"]=SimpleEventEmitter;

},{"./utils":13}],13:[function(require,module,exports){
function once(e){var r=!1;return function(){return r?void 0:(r=!0,e.apply(this,arguments))}}function unique(e){var r=[];return e.forEach(function(e){-1===r.indexOf(e)&&r.push(e)}),r}function isPlainObject(e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype}function makeNonEnumerable(e,r){for(var n=0;n<r.length;n++)Object.defineProperty(e,r[n],{configurable:!0,writable:!0,enumerable:!1,value:e[r[n]]})}function deepEquals(e,r){if(null===e&&null===r)return!0;if(void 0===e&&void 0===r)return!0;var n=Array.isArray(e)||e instanceof observablearray_1.ObservableArray;if(n!==(Array.isArray(r)||r instanceof observablearray_1.ObservableArray))return!1;if(n){if(e.length!==r.length)return!1;for(var t=e.length;t>=0;t--)if(!deepEquals(e[t],r[t]))return!1;return!0}if("object"==typeof e&&"object"==typeof r){if(null===e||null===r)return!1;if(Object.keys(e).length!==Object.keys(r).length)return!1;for(var u in e){if(!r.hasOwnProperty(u))return!1;if(!deepEquals(e[u],r[u]))return!1}return!0}return e===r}function quickDiff(e,r){if(!r||!r.length)return[e,[]];if(!e||!e.length)return[[],r];for(var n=[],t=[],u=0,i=0,a=e.length,l=!1,o=0,f=0,s=r.length,c=!1,p=!1;!p&&!l;){if(!c){if(a>u&&s>o&&e[u]===r[o]){if(u++,o++,u===a&&o===s)return[n,t];continue}i=u,f=o,c=!0}f+=1,i+=1,f>=s&&(p=!0),i>=a&&(l=!0),l||e[i]!==r[o]?p||r[f]!==e[u]||(t.push.apply(t,r.slice(o,f)),o=f+1,u++,c=!1):(n.push.apply(n,e.slice(u,i)),u=i+1,o++,c=!1)}return n.push.apply(n,e.slice(u)),t.push.apply(t,r.slice(o)),[n,t]}exports.once=once,exports.unique=unique,exports.isPlainObject=isPlainObject,exports.makeNonEnumerable=makeNonEnumerable,exports.deepEquals=deepEquals,exports.quickDiff=quickDiff;var observablearray_1=require("./observablearray");

},{"./observablearray":6}]},{},[4])(4)
});
//# sourceMappingURL=mobservable.min.js.map
