<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Reference Guide | Introduction</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.2.0">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
    

        
    
    
    <link rel="next" href="../best/devtools.html" />
    
    
    <link rel="prev" href="../best/store.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="4" data-basepath=".." data-revision="Tue Sep 15 2015 04:20:12 GMT+0200 (CEST)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" >
            
            <span><b>1.</b> Introduction to Mobservable</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Why Mobservable?
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="intro/overview.html">
            
                
                    <a href="../intro/overview.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        The Gist of Mobservable
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="intro/concepts.html">
            
                
                    <a href="../intro/concepts.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        Concepts &amp; Principles
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" >
            
            <span><b>2.</b> The Basics: Making stuff Reactive</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="core/reactive-state.html">
            
                
                    <a href="../core/reactive-state.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Reactive Data Structures
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="core/reactive-views.html">
            
                
                    <a href="../core/reactive-views.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Reactive Views
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="core/reactive-component.html">
            
                
                    <a href="../core/reactive-component.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Reactive Components
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" >
            
            <span><b>3.</b> Best Practices For Large Apps</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="best/store.html">
            
                
                    <a href="../best/store.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Organizing data stores
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" >
            
            <span><b>3.2.</b> Organizing components</span>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" >
            
            <span><b>3.3.</b> Organizing actions</span>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" >
            
            <span><b>3.4.</b> Working with async actions</span>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" >
            
            <span><b>3.5.</b> Routing</span>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" >
            
            <span><b>3.6.</b> Universal applications</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="4" data-path="refguide/api.html">
            
                
                    <a href="../refguide/api.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Reference Guide
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" >
            
            <span><b>5.</b> How does Mobservable work?</span>
            
            
        </li>
    
        <li class="chapter " data-level="6" >
            
            <span><b>6.</b> Tips &amp; Tricks</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="best/devtools.html">
            
                
                    <a href="../best/devtools.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        DevTools
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="best/syntax.html">
            
                
                    <a href="../best/syntax.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                        ES6 &amp; TypeScript goodies
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.3" >
            
            <span><b>6.3.</b> Tracking state changes</span>
            
            
        </li>
    
        <li class="chapter " data-level="6.4" >
            
            <span><b>6.4.</b> Predicates</span>
            
            
        </li>
    
        <li class="chapter " data-level="6.5" >
            
            <span><b>6.5.</b> Performance considerations</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" data-path="LINKS.html">
            
                
                    <a href="../LINKS.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Resources
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="faq/faq.html">
            
                
                    <a href="../faq/faq.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Frequently Asked Questions
                    </a>
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Introduction</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <p>Disclaimer: this document is work in progress but reflects the latest 0.6 release.</p>
<h1 id="reference-guide">Reference Guide</h1>
<p>Mobservable divides your application into three different concepts:</p>
<ol>
<li>State</li>
<li>Views on your state</li>
<li>State management</li>
</ol>
<p><em>State</em> is is all the factual information that lives inside your application.
This might be the profile of the user that is logged in, the tasks he needs to manage, or the fact that the sidebar currently collapsed.
With Mobservable you can make your state reactive. This means that all derived views based on your state are updated automatically.
The first section of this api documentation describes how to <a href="#making-state-reactive">make data reactive</a>.</p>
<p><em>Views</em> are all pieces of information that can be derived from the <em>State</em> or its mutations.
For example; the amount of unfinished tasks, the user interface and the data mutations that need to be synced with the server.
Those are all forms of views.
The second section describes how to <a href="#reacting-to-state-changes">react to data changes</a>.</p>
<p>Finally your application has actions that <em>change state</em>.
Mobservable does not dictate how to change your state.
Instead of that, Mobservable tries to be as unobtrusive as possible.
You can use mutable objects and arrays, real references, classes and cyclic data structures to store your state.
With Mobservable you are free to mutate that state in any way you think is the best.</p>
<p>Different examples of storing state in ES5, ES6, or TypeScript, using plain objects, constructor functions or classes can be found in the <a href="syntax.md">syntax documentation</a>.</p>
<p>The third section describes some <a href="#utility-functions">utility functions</a> that might come in convenient.</p>
<h2 id="making-state-reactive">Making state reactive</h2>
<h3 id="makereactive-data-options">makeReactive(data, options)</h3>
<p><code>makeReactive</code> is the swiss knife of <code>mobservable</code>. It converts <code>data</code> to something reactive.
The following types are distinguished, details are described below.</p>
<ul>
<li><code>Primitive</code>: Any boolean, string, number, null, undefined, date, or regex.</li>
<li><code>PlainObject</code>: Any raw javascript object that wasn&apos;t created using a constructor function</li>
<li><code>ComplexObject</code>: A javascript object that was created by a constructor function (using the <code>new</code> keyword, with the sole exception of <code>new Object</code>).</li>
<li><code>Array</code>: A javascript array; anything which <code>Array.isArray</code> yields true.</li>
<li><code>ViewFuncion</code>: A function that takes no arguments but produces a value based on its scope / closure.</li>
<li><code>ComplexFunction</code>: A function that takes one or more arguments and might produce a value</li>
</ul>
<h4 id="primitive-values">Primitive values</h4>
<p>If <code>data</code> is a primitive value, <em>complex</em> object or function, a getter/setter function is returned:
a function that returns its current value if invoked without arguments, or updates its current value if invoked with exactly one argument.
If updated, it will notify all its <em>observers</em>.</p>
<p>New observers can be registered by invoking the <em>.observe(callback, invokeImmediately=false)</em> method.
If the second parameter passed to <code>.observe</code> is true, the callback will be invoked with the current value immediately.
Otherwise the callback will be invoked on the first change.
Note that you might never use <code>.observe</code> yourself; as creating new <a href="#reacting-to-state-changes">reactive functions or side-effects</a> is a more high-level approach to observe one or more values.</p>
<p>In practice you will hardly use <code>makeReactive</code> for primitives, as most primitive values will belong to some object.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> temperature = makeReactive(<span class="hljs-number">25</span>);
temperature.observe(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">newTemperature, oldTemperature</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;Temperature changed from &apos;</span>, oldTemperature, <span class="hljs-string">&apos; to &apos;</span>, newTemperature);
});
temperature(<span class="hljs-number">30</span>);
<span class="hljs-comment">// prints: &apos;Temperature changed from 25 to 30&apos;</span>
<span class="hljs-built_in">console</span>.log(temperature());
<span class="hljs-comment">// prints: &apos;30&apos;.</span>
</code></pre>
<h4 id="plain-objects">Plain objects</h4>
<p>If <code>makeReactive</code> is invoked on a plain objects, a new plain object with reactive properties based on the original properties will be returned.
<code>makeReactive</code> will recurse into all property values of the original object.
Any values that will be assigned to these properties in the future, will be made reactive as well if needed.</p>
<p>View functions inside the object will become reactive properties of the object (see the next section for more info about reactive functions).
Their <code>this</code> will be bound to the object automatically.</p>
<p>Properties that will be added to the reactive object later on won&apos;t become reactive automatically.
This makes it easy to extend objects with, for example, functions that are not reactive themselves but instead mutate the object.
If you want to add a new reactive property to an existing object, just use <code>extendReactive</code>.</p>
<p>Example:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> orderLine = makeReactive({
  price: <span class="hljs-number">10</span>,
  amount: <span class="hljs-number">1</span>,
  total: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.price * <span class="hljs-keyword">this</span>.amount;
  }
});

<span class="hljs-comment">// sideEffect is explained below,</span>
mobservable.sideEffect(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(orderline.total);
});
<span class="hljs-comment">// prints: 10</span>

orderLine.amount = <span class="hljs-number">3</span>;
<span class="hljs-comment">// prints: 30</span>
</code></pre>
<p>The recommended way to create reactive objects is to create a constructor function and use <code>extendReactive(this, properties)</code> inside the constructor;
this keeps the responsibility of making an object inside the object and makes it impossible to accidentally use a non-reactive version of the object.
However, some prefer to not use constructor functions at all in javascript applications.
So Mobservable will work just as fine when using <code>makeReactive(plainObject)</code>.</p>
<h4 id="complex-objects">Complex objects</h4>
<p>Passing non-plain objects to <code>makeReactive</code> will result in a reactive reference to the object, similar to creating reactive primitive values.
The constructor of such objects is considered responsible for creating reactive properties if needed.</p>
<h4 id="arrays">Arrays</h4>
<p>For arrays a new, reactive array will be returned.
Like with plain objects, reactiveness is a contagious thing; all values of the array,
now or in the future, will be made reactive as well if needed.</p>
<p>Arrays created using <code>makeReactive</code> provide a thin abstraction over native arrays.
The most notable difference between built-in arrays is that reactive arrays cannot be sparse;
values assigned to an index larger than <code>length</code> are considered to be out-of-bounds and will not become reactive.</p>
<p>Furthermore, <code>Array.isArray(reactiveArray)</code> and <code>typeof reactiveArray === &quot;array&quot;</code> will yield <code>false</code> for reactive arrays,
but <code>reactiveArray instanceof Array</code> will return <code>true</code>.</p>
<p>This has consequences when passing arrays to external methods or built-in functions, like <code>array.concat</code>, as they might not handle reactive arrays correctly.
(This might improve in the future).</p>
<p><strong><em>To avoid issues with other libraries, just make defensive copies before passing reactive arrays to external libraries using <code>array.slice()</code>.</em></strong></p>
<p>Reactive arrays support all available ES5 array methods. Besides those, the following methods are available as well:</p>
<ul>
<li><code>observe(listener, fireImmediately? = false)</code> Listen to changes in this array. The callback will receive arguments that express an array splice or array change, conforming to <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/observe" target="_blank">ES7 proposal</a>. It returns a disposer function to stop the listener.</li>
<li><code>clear()</code> Remove all current entries from the array.</li>
<li><code>replace(newItems)</code> Replaces all existing entries in the array with new ones.</li>
<li><code>find(predicate: (item, index, array) =&gt; boolean, thisArg?, fromIndex?)</code> Find implementation, basically the same as the ES7 Array.find proposal, but with added <code>fromIndex</code> parameter.</li>
<li><code>remove(value)</code> Remove a single item by value from the array. Returns true if the item was found and removed.</li>
</ul>
<h4 id="functions">Functions</h4>
<p>Those are explained in the next <a href="#reacting-to-state-changes">section</a>.</p>
<h4 id="further-notes-on-makereactive">Further notes on <code>makeReactive</code>.</h4>
<p><code>makeReactive</code> will not recurse into non-plain objects, multi-argument functions and any value that is wrapped in <code>asReference</code>.</p>
<p><code>makeReactive</code> will not recurse into objects that already have been processed by <code>makeReactive</code> or <code>extendReactive</code>.</p>
<p>The second <code>options</code> parameter object is optional but can define using following flags:</p>
<ul>
<li><code>as</code> specifies what kind of reactive object should be made. Defaults to <code>&quot;auto&quot;</code>. Other valid values are <code>&quot;reference&quot;</code>, <code>&quot;struct&quot;</code> (in a later version see #8).</li>
<li><code>scope</code> defined the <code>this</code> of reactive functions. Will be set automatically in most cases</li>
<li><code>recurse</code> defaults <code>true</code>. If <code>false</code>, <code>makeActive</code> will not recurse into any child values.</li>
<li><code>name</code>: can be set to assign a name to this observable, used by the developers tools in the <code>extras</code> namespaces.</li>
<li><code>context</code> can be set to specify a certain context which is reported by the developers tools defined in the <code>extras</code>namespaces. Defaults to the object which caused this value to become reactive.</li>
</ul>
<p>More flags will be made available in the feature.</p>
<p><code>makeReactive</code> is the default export of the <code>mobservable</code> module, so you can use <code>mobservable(data, opts)</code> as a shorthand.</p>
<h3 id="extendreactive-target-properties">extendReactive(target, properties)</h3>
<p><code>extendReactive</code> works similarly to <code>makeReactive</code>, but it extends an existing object instead of creating a new one. Similar to <code>Object.assign</code> or <code>jQuery.extend</code>.
This is especially useful inside constructor functions or to extend existing (possibly already reactive) objects.</p>
<p>In general, it is better to use <code>extendReactive(target, { property : value })</code> than <code>target.property = makeReactive(value)</code>.
The difference is that in the later only creates a reactive value, while <code>extendReactive</code> will make the property itself reactive as well,
so that you can safely assign new values to it later on.</p>
<h3 id="asreference-value">asReference(value)</h3>
<p>See <code>makeReactive</code>, the given value will not be converted to a reactive structure if it is added to another reactive structure.
The reference to it will be observable nonetheless.</p>
<p>In the following example the properties of the dimensions object itself won&apos;t be reactive, but assigning a new object value to the <code>image.dimension</code> will be picked up:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> image = makeReactive({
  src: <span class="hljs-string">&quot;/some/path&quot;</span>,
  dimension: asReference({
    width: <span class="hljs-number">100</span>,
    height: <span class="hljs-number">200</span>
  })
});
</code></pre>
<h3 id="observable">observable</h3>
<p>Decorator (or annotation) that can be used on ES6 or TypeScript properties to make them reactive.</p>
<p>Note that in ES6 the annotation can only be used on getter functions, as ES6 doesn&apos;t support property initializers in class declarations.
See also the <a href="syntax.md">syntax section</a> to see how <code>@observable</code> can be combined with different flavors of javascript code.</p>
<pre><code class="lang-javascript"><span class="hljs-comment">/// &lt;reference path=&quot;./node_modules/mobservable/dist/mobservable.d.ts&quot;/&gt;</span>
<span class="hljs-keyword">import</span> {observable, sideEffect} <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mobservable&quot;</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Order</span> </span>{
    @observable orderLines: OrderLine[] = [];
    @observable get total() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.orderLines.reduce((sum, orderLine) =&gt; sum + orderLine.total, <span class="hljs-number">0</span>)
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderLine</span> </span>{
    @observable price:number = <span class="hljs-number">0</span>;
    @observable amount:number = <span class="hljs-number">1</span>;

    constructor(price) {
        <span class="hljs-keyword">this</span>.price = price;
    }

    @observable get total() {
        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Total: &quot;</span> + <span class="hljs-keyword">this</span>.price * <span class="hljs-keyword">this</span>.amount;
    }
}
</code></pre>
<h2 id="reacting-to-state-changes">Reacting to state changes</h2>
<h3 id="makereactive-function-options">makeReactive(function, options)</h3>
<p>Responding to changes in your state is simply the matter of passing a <code>function</code> that takes no parameters to <code>makeReactive</code>.
Mobservable will track which reactive objects, array and other reactive functions are used by the provided function.
Mobservable will call <code>function</code> again when any of those values have changed.</p>
<p>This will happen in such a way one can never observe a stale output of <code>function</code>; updates are pushed synchronously.
Invocations of <code>function</code> will only happen when none of its dependencies is stale, so that updates are atomic.
This is a major difference with many other reactive frameworks.
This sounds complicated and expensive but in practice you won&apos;t notice any performance overhead in any reasonable scenario.
Reactive functions evaluate lazily; if nobody is observing the reactive function it will never evaluate.
For non-lazy reactive functions see <code>sideEffect</code>.</p>
<p>Invoking <code>makeReactive</code> directly on a function will result in a <em>getter function</em>, similar to invoking <code>makeReactive</code> on primitive values.
If <code>makeReactive</code> encounters a function inside an object passed through it,
it will introduce a new property on that object, that uses the function as getter function for that property.</p>
<p>The optional <code>options</code> parameter is an object.
The <code>scope</code> property of that object can be set to define the <code>this</code> value that will be used inside the reactive function.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> greeter = makeReactive({
  who: <span class="hljs-string">&quot;world&quot;</span>,
  greeting: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello, &quot;</span> + <span class="hljs-keyword">this</span>.who + <span class="hljs-string">&quot;!!!&quot;</span>;
  }
});

<span class="hljs-keyword">var</span> upperCaseGreeter = makeReactive(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> greeter.greeting; <span class="hljs-comment">// greeting has become an reactive property</span>
});

<span class="hljs-keyword">var</span> disposer = upperCaseGreeter.observe(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">newGreeting</span>) </span>{
  <span class="hljs-built_in">console</span>.log(newGreeting)
});

greeter.who = <span class="hljs-string">&quot;Universe&quot;</span>;
<span class="hljs-comment">// Prints: &apos;HELLO, UNIVERSE!!!&apos;</span>

disposer(); <span class="hljs-comment">// stop observing</span>
<span class="hljs-built_in">console</span>.log(greeter.greeting); <span class="hljs-comment">// prints the latest version of the reactive, derived property</span>
<span class="hljs-built_in">console</span>.log(upperCaseGreeter()); <span class="hljs-comment">// prints the latest version of the reactive function</span>
</code></pre>
<h3 id="sideeffect-function">sideEffect(function)</h3>
<p><code>sideEffect</code> can be used in those cases where you want to create a reactive function that will never have observers itself.
This is usually the case when you need to bridge from reactive to imperative code, for example for logging, persistence or UI-updating code.
When <code>sideEffect</code> is used, <code>function</code> will always be
triggered when one of its dependencies changes.
(In contrast, <code>makeReactive(function)</code> creates functions that only re-evaluate if it has
observers on its own, otherwise its value is considered to be irrelevant).</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> numbers = makeReactive([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]);
<span class="hljs-keyword">var</span> sum = makeReactive(() =&gt; numbers.reduce((a, b) =&gt; a + b, <span class="hljs-number">0</span>);

<span class="hljs-keyword">var</span> loggerDisposer = sideEffect(() =&gt; <span class="hljs-built_in">console</span>.log(sum());
<span class="hljs-comment">// prints &apos;6&apos;</span>
numbers.push(<span class="hljs-number">4</span>);
<span class="hljs-comment">// prints &apos;10&apos;</span>

loggerDisposer();
numbers.push(<span class="hljs-number">5</span>);
<span class="hljs-comment">// won&apos;t print anything, nor is `sum` re-evaluated</span>
</code></pre>
<p>Fun fact: <code>sideEffect(func)</code> is actually an alias for <code>makeReactive(func).observe(function() { /* noop */ });</code>.</p>
<h3 id="reactivecomponent-component">reactiveComponent(component)</h3>
<p><code>reactiveComponent</code> turns a ReactJS component into a reactive one and is provided through the separate (and minimal) <code>mobservable-react</code> package.
Making a component reactive means that it will automatically observe any reactive data it uses.</p>
<p>It is quite similar to <code>@connect</code> as found in several flux libraries, yet there are two important differences.
With <code>@reactiveComponent</code> you don&apos;t need to specify which store / data should be observed in order to re-render at the appropriate time.
Secondly, reactive components provide far more fine grained update semantics: Reactive components won&apos;t be observing a complete store or data tree, but only that data that is actually used during the rendering of the component. This might be a complete list, but also a single object or even a single property.
The consequence of this is that components won&apos;t re-render unless some data that is actually used in the rendering has changed. Large applications really benefit from this in terms of performance.</p>
<p>Rule of thumb is to use <code>reactiveComponent</code> on every component in your application that is specific for your application.
Its overhead is neglectable and it makes sure that whenever you start using reactive data the component will respond to it.
One exception are general purposes components that are not specific for your app. As these probably don&apos;t depend on the actual state of your application.
For that reason it doesn&apos;t make sense to add <code>reactiveComponent</code> to them (unless their own state is expressed using reactive data structures as well).</p>
<p>The <code>reactiveComponent</code> function / decorator supports both components that are constructed using <code>React.createClass</code> or using ES6 classes that extend <code>React.Component</code>. <code>reactiveComponent</code> is also available as mixin: <code>mobservable.reactiveMixin</code>.</p>
<p><code>reactiveComponent</code> also prevents re-renderings when the <em>props</em> of the component have only shallowly changed, which makes a lot of sense if the data passed into the component is reactive.
This behavior is similar to <a href="https://facebook.github.io/react/docs/pure-render-mixin.html" target="_blank">React PureRender mixin</a>, except that <em>state</em> changes are still always processed.
If a component provides its own <code>shouldComponentUpdate</code>, that one takes precedence.</p>
<p>Since in practice you will see that most reactive components become stateless, they can easily be hot-reloaded.</p>
<p><em>Note: when <code>reactiveComponent</code> needs to be combined with other decorators or higher-order-components, make sure that <code>reactiveComponent</code> is the most inner (first applied) decorator;
otherwise it might do nothing at all.</em></p>
<p><strong>ES6 class + decorator</strong></p>
<pre><code class="lang-javascript">@reactiveComponent <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyCompoment</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  <span class="hljs-comment">/* .. */</span>
}
</code></pre>
<p><strong>ES6 class + function call</strong></p>
<pre><code class="lang-javascript">reactiveComponent(<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyCompoment</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  <span class="hljs-comment">/* .. */</span>
});
</code></pre>
<p><strong>ES5 + React.createClass</strong></p>
<pre><code class="lang-javascript">reactiveComponent(React.createClass({
  <span class="hljs-comment">/* .. */</span>
}))
</code></pre>
<h2 id="utility-functions">Utility functions</h2>
<h3 id="isreactive-value">isReactive(value)</h3>
<p>Returns true if the given value was created or extended by mobservable. Note: this function cannot be used to tell whether a property is reactive; it will determine the reactiveness of its actual value.</p>
<h3 id="tojson-value">toJson(value)</h3>
<p>Converts a non-cyclic tree of observable objects into a JSON structure that is not observable. It is kind of the inverse of <code>mobservable.makeReactive</code></p>
<h3 id="transaction-workerfunction">transaction(workerFunction)</h3>
<p>Transaction postpones the updates of computed properties until the (synchronous) <code>workerFunction</code> has completed.
This is useful if you want to apply a bunch of different updates throughout your model before needing the updated computed values, e.g. while refreshing data from the back-end.
In practice, you will probably never need <code>.transaction</code>, since observables typically update wickedly fast.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> amount = mobservable(<span class="hljs-number">3</span>);
<span class="hljs-keyword">var</span> price = mobservable(<span class="hljs-number">2.5</span>);
<span class="hljs-keyword">var</span> total = mobservable(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> amount() * price();
});
total.observe(<span class="hljs-built_in">console</span>.log);

<span class="hljs-comment">// without transaction:</span>
amount(<span class="hljs-number">2</span>); <span class="hljs-comment">// Prints 5</span>
price(<span class="hljs-number">3</span>); <span class="hljs-comment">// Prints 6</span>

<span class="hljs-comment">// with transaction:</span>
mobservable.transaction(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    amount(<span class="hljs-number">3</span>);
    price(<span class="hljs-number">4</span>);
});
<span class="hljs-comment">// Prints 12, after completing the transaction</span>
</code></pre>
<h3 id="extras-getdependencytree-thing-property">extras.getDependencyTree(thing, property?)</h3>
<p>Accepts something reactive and prints its current dependency tree; other reactive values it depends on. For sideEffects, this method can be invoked on its disposer.
Works for React components as well, but only if they are actually mounted (otherwise they won&apos;t be observing any data).
For object properties, pass in the property name as second argument. <code>id</code> is unique and generated by mobservable.
<code>name</code> and <code>context</code> are determined automatically, unless they were overriden in the options passed to <code>makeReactive</code>.
The returned dependency tree is a recursive structure with the following signature:</p>
<pre><code class="lang-javascript">interface IDependencyTree {
    id: number;
    name: string;
    context: any;
    dependencies?: IDependencyTree[];
}
</code></pre>
<h3 id="extras-getobservertree-thing-property">extras.getObserverTree(thing, property?)</h3>
<p>Similar to <code>getDependencyTree</code>, but observer tree returns a tree of all objects that are depending on <code>thing</code>. It returns a tree structure with the following structure:</p>
<pre><code class="lang-javascript">interface IObserverTree {
    id: number;
    name: string;
    context: any;
    observers?: IObserverTree[];
    listeners?: number;
}
</code></pre>
<p><code>listeners</code> defines the amount of external observers, attached by using <code>.observe</code> of some reactive value. Side-effects will always report 1 listener.</p>
<h3 id="extras-tracktransitions-extensive-onreport">extras.trackTransitions(extensive, onReport)</h3>
<p>Debugging tool that reports each change in a reactive value.
The optional <code>extensive</code> boolean indicates whether all control events should be reported, or only the events that changes a value. Defaults to <code>false</code>.
The <code>onReport</code> function is a callback that will be invoked for each transition. If omitted, the reports will be printed to the console.
<code>trackTransitions</code> returns a function that can be used to stop the tracker.</p>
<p>Each transition is reported as an object with the following signature. The <code>state</code> value is either <code>STALE</code>, <code>PENDING</code> or <code>READY</code>.</p>
<pre><code class="lang-javascript">interface ITransitionEvent {
    id: number;
    name: string;
    context: <span class="hljs-built_in">Object</span>;
    state: string;
    changed: boolean;
    newValue: string;
}
</code></pre>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../best/store.html" class="navigation navigation-prev " aria-label="Previous page: Organizing data stores"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../best/devtools.html" class="navigation navigation-next " aria-label="Next page: DevTools"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-disqus/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"ga":{"token":"UA-65632006-1","configuration":"auto"},"disqus":{"shortName":"mobservable"}};
    gitbook.start(config);
});
</script>

        <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-65632006-1', 'auto');ga('send', 'pageview');</script>
    </body>
    
</html>
